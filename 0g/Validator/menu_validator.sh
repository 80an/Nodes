#!/bin/bash

# –§–∞–π–ª –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
ENV_FILE="$HOME/.validator_env"
BASHRC_FILE="$HOME/.bashrc"

# –ü—Ä–æ–≤–µ—Ä–∫–∞, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ–∞–π–ª .env –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
if [ -f "$ENV_FILE" ]; then
  echo "$ENV_FILE –Ω–∞–π–¥–µ–Ω. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ..."
  # –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env —Ñ–∞–π–ª–∞
  source "$ENV_FILE"
  echo "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ .env —Ñ–∞–π–ª–∞."
else
  echo "$ENV_FILE –Ω–µ –Ω–∞–π–¥–µ–Ω. –í—ã–ø–æ–ª–Ω–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö."
  
  # –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  read -s -p "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è Keyring: " KEYRING_PASSWORD
  echo

  echo "–í—ã–±–µ—Ä–∏—Ç–µ, —á—Ç–æ –≤–≤–æ–¥–∏—Ç—å:"
  echo "1) –ò–º—è –∫–æ—à–µ–ª—å–∫–∞"
  echo "2) –ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞"
  read -p "–ß—Ç–æ –≤—ã–±–∏—Ä–∞–µ—Ç–µ? (1 –∏–ª–∏ 2): " choice

  if [ "$choice" -eq 1 ]; then
    # –í–≤–æ–¥–∏–º –∏–º—è –∫–æ—à–µ–ª—å–∫–∞
    read -p "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∫–æ—à–µ–ª—å–∫–∞: " WALLET_NAME
  elif [ "$choice" -eq 2 ]; then
    # –í–≤–æ–¥–∏–º –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞
    read -p "–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞: " WALLET_ADDRESS
  else
    echo "–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ 1 –∏–ª–∏ 2."
    exit 1
  fi

  echo
  echo ".env —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è!"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ .bashrc
if ! grep -q "source \$HOME/.env" "$BASHRC_FILE"; then
  echo "–î–æ–±–∞–≤–ª—è–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ .env –≤ .bashrc..."
  echo -e "\n# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ .env\nif [ -f \"\$HOME/.env\" ]; then\n  source \"\$HOME/.env\"\nfi" >> "$BASHRC_FILE"
  echo "–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ .bashrc."
else
  echo "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ .bashrc."
fi

# –ú–µ–Ω—é –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–º
while true; do
  echo
  echo "========= üìã –ú–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–º ========="
  echo "1) üí∞ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 1"
  echo "2) üí∏ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 2"
  echo "3) üì• –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 3"
  echo "4) üó≥ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 4"
  echo "5) üö™ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 5"
  echo "6) ‚úÖ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 6"
  echo "7) ‚õî –ü—É—Å—Ç–æ–µ –º–µ–Ω—é"
  echo "8) ‚ùå –í—ã—Ö–æ–¥"
  echo "=================================================="
  echo

  read -p "–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –º–µ–Ω—é (1-8): " choice

  case $choice in
    1)
      echo "üí∞ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 1"
      # –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ –Ω—É–∂–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –ø—É–Ω–∫—Ç–∞ 1
      ;;
    2)
      echo "üí∏ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 2"
      # –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ –Ω—É–∂–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –ø—É–Ω–∫—Ç–∞ 2
      ;;
    3)
      echo "üì• –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 3"
      # –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ –Ω—É–∂–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –ø—É–Ω–∫—Ç–∞ 3
      ;;
    4)
      echo "üó≥ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 4"
      # –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ –Ω—É–∂–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –ø—É–Ω–∫—Ç–∞ 4
      ;;
    5)
      echo "üö™ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 5"
      # –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ –Ω—É–∂–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –ø—É–Ω–∫—Ç–∞ 5
      ;;
    6)
      echo "‚úÖ –ü—É—Å—Ç–æ–π –ø—É–Ω–∫—Ç 6"
      # –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ –Ω—É–∂–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –ø—É–Ω–∫—Ç–∞ 6
      ;;
    7)
      echo "‚õî –ü–æ–∫–∞ –ø—É—Å—Ç–æ–µ –º–µ–Ω—é..."
      ;;
    8)
      echo "‚ùå –í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã..."
      break  # –≠—Ç–æ –∑–∞–º–µ–Ω—è–µ—Ç exit 0 –∏ –Ω–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Å–µ—Å—Å–∏—é
      ;;
    *)
      echo "üö´ –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –æ—Ç 1 –¥–æ 8."
      ;;
  esac
done
