#!/bin/bash

REPO_URL="https://github.com/80an/Nodes"
TARGET_DIR="$HOME/validator-tools"

show_menu() {
  clear
  echo "========= üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ 0G Validator ========="
  echo "1) üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–ø—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–º"
  echo "2) üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç (–ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)"
  echo "3) ‚ùå –£–¥–∞–ª–∏—Ç—å —Å–∫—Ä–∏–ø—Ç (–ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)"
  echo "4) üö™ –í—ã–π—Ç–∏"
  echo "======================================================"
}

download_scripts() {
  echo "üì• –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ $TARGET_DIR ..."
  mkdir -p "$TARGET_DIR"
  cd "$TARGET_DIR" || exit

  # –°–∫–∞—á–∏–≤–∞–µ–º –∞—Ä—Ö–∏–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
  wget -qO- "$REPO_URL/archive/refs/heads/main.tar.gz" | tar -xz --strip-components=2 Nodes-main/0g/Validator

  # –î–µ–ª–∞–µ–º –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ –≤—Å–µ .sh-—Ñ–∞–π–ª—ã
  find "$TARGET_DIR" -type f -name "*.sh" -exec chmod +x {} \;

  echo "‚úÖ –°–∫—Ä–∏–ø—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ $TARGET_DIR"
  echo
  read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
}

while true; do
  show_menu
  read -p "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: " choice
  case $choice in
    1)
      download_scripts
      ;;
    2)
      echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)"
      # –¢—É—Ç –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å GitHub
      read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
      ;;
    3)
      echo "‚ùå –£–¥–∞–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)"
      # rm -rf "$TARGET_DIR"
      read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
      ;;
    4)
      echo "üö™ –í—ã—Ö–æ–¥..."
      break
      ;;
    *)
      echo "‚ùó –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É."
      ;;
  esac
done
